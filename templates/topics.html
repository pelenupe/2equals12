{% extends "layout.html" %}

{% block title %}Topics | 2 Equals 12{% endblock %}

{% block content %}

<div id="hero" class="relative min-h-screen flex flex-col items-center justify-flex-start px-12 py-10 bg-center bg-cover">

    <!-- Hero Overlay -->
    <div class="absolute inset-0 z-0 hero-overlay"></div>

    <div class="main-text">
    <h1 class="text-3xl text-black mb-10 text-center">Search Topics</h1>

  <div class="w-full">
    <input 
      id="search-input" 
      type="text" 
      placeholder="Start typing to search topics..." 
      class="text-black p-3 w-full border rounded mb-4"
      autocomplete="on"
    >
    <ul id="suggestions" class="bg-black border rounded shadow-md hidden"></ul>
  </div>
  <div class="mt-6">
    <p><a href="/" class="text-sm text-green-400 underline">‚Üê Back Home</a></p>
</div>
</div>

<script>
const allTags = JSON.parse('{{ all_tags|tojson|safe }}');
const input = document.getElementById('search-input');
const suggestions = document.getElementById('suggestions');

input.addEventListener('input', function() {
  const value = this.value.toLowerCase();
  suggestions.innerHTML = '';

  if (value.length === 0) {
    suggestions.classList.add('hidden');
    return;
  }

  const matches = allTags.filter(tag => tag.toLowerCase().includes(value));

  if (matches.length === 0) {
    suggestions.classList.add('hidden');
    return;
  }

  matches.forEach(tag => {
    const li = document.createElement('li');
    li.textContent = tag;
    li.className = 'p-2 hover:bg-green cursor-pointer';
    li.onclick = () => {
      window.location.href = `/explore/${encodeURIComponent(tag)}`;
    };
    suggestions.appendChild(li);
  });

  suggestions.classList.remove('hidden');
});

document.addEventListener('click', function(event) {
  if (!input.contains(event.target) && !suggestions.contains(event.target)) {
    suggestions.classList.add('hidden');
  }
});
</script>
</div>
</div>
{% endblock %}
